"use strict";var protocol=(getParameterValueFromUrl("protocol",window.location.href)||"http")+"://";function initHeaderLoginEvents(){processEmailLogin(),processLinks(),processSocialLoginEvents()}function getParameterValueFromUrl(e,o){return getQueryStringParams(o||window.location.search)[e]}function getQueryStringParams(e){if(!e||0===e.length)return{};var a={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,o,t,n){a[o]=decodeURIComponent(n).replace(/\+/g," ")}),a}function processSocialLoginEvents(){var t=$("form.js-social-login");t.on("submit",function(){return!1}),t.length&&t.find("button.oAuthIcon").on("click",function(e){e.preventDefault();var o=$(this).closest(".error-form");t.find("#OAuthProvider").val($(this).attr("id")),$.ajax({url:t.attr("action"),data:t.serialize()}).done(function(e){e&&e.success?(o.addClass("g-hidden"),window.parent.postMessage({eventType:"goto",url:e.location},protocol+window.location.hostname)):o.removeClass("g-hidden")})})}function processLinks(){$("body").on("click","a",function(e){e.preventDefault();var o=$(this).attr("href");o&&"#"!=o&&window.parent.postMessage({eventType:"goto",url:o},protocol+window.location.hostname)})}function processEmailLogin(){var o,t,n,a,i=$(".js-header-login .js-login-form");i.length&&(initValidation(i),i.on("submit",function(e){if(e.preventDefault(),!i.valid())return!1;(t=$(this).find("button")).length&&(n=$(this).attr("action"),a=$(this).find(".error-form"),o=$(this).serialize(),o+="&"+t.attr("name")+"="+t.val(),o+="&urlpath="+document.referrer,o+="&format=ajax",$.ajax({url:n,data:o}).done(function(e){e&&e.success?(a.addClass("m-hidden"),e.proceedpage.length?window.parent.postMessage({eventType:"goto",url:e.proceedpage},protocol+window.location.hostname):window.parent.postMessage({eventType:"refresh"},protocol+window.location.hostname)):a.removeClass("h-hidden")}))}))}function initValidation(e){var o=$("#js-validator-messages").data("messages");o&&$.extend($.validator.messages,o),e.validate({onfocusout:function(e){this.checkable(e)||this.element(e)}})}initHeaderLoginEvents();